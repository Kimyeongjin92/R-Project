Cl_top    <- sort(table(Cl), decreasing = T)
windowsFonts(baedal=windowsFont("배달의민족 도현"))
a <- "white"
a <- c(a, rep("gold", length(Cl_top)))
wordcloud2(Cl_top,
size=0.7,
minSize=0,
gridSize=8,                # cloud 크기(2)
col=a,           # 색 변경 random-dark, random-light, rep(brewer.pal(8, "Dark2"), length.out=100)
rotateRatio=0,             # 회전 정도 조절
backgroundColor = "black", # 배경 색
shape = 'star',            # circle
shuffle = T,
fontFamily = 'baedal',
fontWeight = 'bold',
ellipticity = 0.65)
# 전처리와 sort가 완료된 table 파일로 만든다.
a <- "white"
a <- c(a, rep("gold", length(Cl_top)))
wordcloud2(Cl_top,
size=0.7,
minSize=0,
gridSize=8,                # cloud 크기(2)
col=a,           # 색 변경 random-dark, random-light, rep(brewer.pal(8, "Dark2"), length.out=100)
rotateRatio=0,             # 회전 정도 조절
backgroundColor = "black", # 배경 색
shape = 'star',            # circle
shuffle = T,
fontFamily = 'baedal',
fontWeight = 'bold',
ellipticity = 0.65)         # 그림의 평형정도
a <- c("white", rep("gold", length(Cl_top)))
wordcloud2(Cl_top,
size=0.7,
minSize=0,
gridSize=8,                # cloud 크기(2)
col=a,           # 색 변경 random-dark, random-light, rep(brewer.pal(8, "Dark2"), length.out=100)
rotateRatio=0,             # 회전 정도 조절
backgroundColor = "black", # 배경 색
shape = 'star',            # circle
shuffle = T,
fontFamily = 'baedal',
fontWeight = 'bold',
ellipticity = 0.65)         # 그림의 평형정도
# 전처리와 sort가 완료된 table 파일로 만든다.
a <- c("white", rep("gold", length(Cl_top)))
wordcloud2(Cl_top,
size=0.7,
minSize=0,
gridSize=8,                # cloud 크기(2)
col=a,           # 색 변경 random-dark, random-light, rep(brewer.pal(8, "Dark2"), length.out=100)
rotateRatio=0,             # 회전 정도 조절
backgroundColor = "black", # 배경 색
shape = 'star',            # circle
shuffle = T,
fontFamily = 'baedal',
fontWeight = 'bold',
ellipticity = 0.65)         # 그림의 평형정도
# 6. wordcloud2 --------------------------------------------------
library(wordcloud2)
Cl <- readLines("클레멘타인_전처리2.txt")
Cl_top    <- sort(table(Cl), decreasing = T)
windowsFonts(baedal=windowsFont("배달의민족 도현"))
a <- "white"
a <- c(a, rep("gold", length(Cl_top)))
wordcloud2(Cl_top,
size=0.7,
minSize=0,
gridSize=8,                # cloud 크기(2)
col=a,           # 색 변경 random-dark, random-light, rep(brewer.pal(8, "Dark2"), length.out=100)
rotateRatio=0,             # 회전 정도 조절
backgroundColor = "black", # 배경 색
shape = 'star',            # circle
shuffle = T,
fontFamily = 'baedal',
fontWeight = 'bold',
ellipticity = 0.65)
# 6. wordcloud2 --------------------------------------------------
library(wordcloud2)
Cl <- readLines("클레멘타인_전처리2.txt")
Cl_top    <- sort(table(Cl), decreasing = T)
windowsFonts(baedal=windowsFont("배달의민족 도현"))
a <- "white"
a <- c(a, rep("gold", length(Cl_top)))
wordcloud2(Cl_top,
size=0.7,
minSize=0,
gridSize=8,                # cloud 크기(2)
col=a,           # 색 변경 random-dark, random-light, rep(brewer.pal(8, "Dark2"), length.out=100)
rotateRatio=0,             # 회전 정도 조절
backgroundColor = "black", # 배경 색
shape = 'star',            # circle
shuffle = T,
fontFamily = 'baedal',
fontWeight = 'bold',
ellipticity = 0.65)
# 6. wordcloud2 --------------------------------------------------
library(wordcloud2)
Cl <- readLines("클레멘타인_전처리2.txt")
Cl_top    <- sort(table(Cl), decreasing = T)
windowsFonts(baedal=windowsFont("배달의민족 도현"))
a <- "white"
a <- c(a, rep("gold", length(Cl_top)))
wordcloud2(Cl_top,
size=0.7,
minSize=0,
gridSize=8,                # cloud 크기(2)
col=a,           # 색 변경 random-dark, random-light, rep(brewer.pal(8, "Dark2"), length.out=100)
rotateRatio=0,             # 회전 정도 조절
backgroundColor = "black", # 배경 색
shape = 'star',            # circle
shuffle = T,
fontFamily = 'baedal',
fontWeight = 'bold',
ellipticity = 0.65)
library(wordcloud)
Cl <- readLines("클레멘타인_전처리2.txt")
Cl_top    <- sort(table(Cl), decreasing = T)
windowsFonts(baedal=windowsFont("배달의민족 도현"))
palete <- brewer.pal(9,"Set3")
par(bg="black")
wordcloud(head(names(Cl_top),1000),
freq=Cl_top,   #
scale=c(4,0.1),   # 빈도가 가장 큰 단어와 가장 빈도가 작은 단어 폰트 사이 크기
rot.per=0.25,     # 90도 회정해서 보여줄 단어 비율.
min.freq=1,       # 이 값 이상 언급된 단어만 출력.
max.words=1000,   # 빈도 3이상 100미만 단어 표현.
random.order=F,   # (F)빈도가 큰 단어를 중앙에 두도록 함.
random.color=F,   # (T)색상랜덤/(F)빈도수순으로 색상표현.
colors=palete,
family="baedal")
legend('top',1,"클레멘타인_WordCloud",
cex=0.8,
fill=NA,
border=NA,
bg="white",
text.col="red",
text.font=2,
box.col="red")
# 1. 년도별 평점합계
library(dplyr)
library(ggplot2)
library(stringr)
clementine<-read.csv('클레멘타인_네이버 리뷰(2).csv')
clementine %>%
filter(년도>2003) %>%
group_by(년도) %>%
summarise(평점합계=sum(점수,na.rm=T),갯수=n(),평점=평점합계/갯수) %>%
ggplot(aes(x=as.factor(년도), y=평점합계, fill=as.factor(년도)))+
geom_bar(stat="identity",color="black") +
geom_point(aes(y=갯수*8),shape=20,size=8,col='red')+
geom_text(aes(y=평점합계+1000,label=paste0(평점합계,"점")),
color='black',
size=5,
family="baedal") +
geom_text(aes(y=갯수*8-1000,label=paste0(갯수,'개')),
color='white',
size=5,
family="baedal") +
geom_text(aes(y=-1000,label=paste0(round(평점,2),'점')),
color='black',
size=5,
family="baedal") +
geom_hline(yintercept=seq(0,30000,2500),lty='dashed',size=0.5) +
theme_bw(base_family='baedal',
base_size = 20,
base_rect_size = 3,
base_line_size = 1) +
labs(x='년도') +
ggtitle('클레멘타인 년도별 평점(막대:합계, 점:갯수, 밑:평점평균)') +
theme(legend.position = "none",
axis.text.x  = element_text(angle=45, hjust=1),
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 30,
color = "black"))
Clementine<-read.csv('클레멘타인_네이버 리뷰(2).csv')
Clementine<-read.csv('클레멘타인_네이버 리뷰(2).csv')
head(Clementine,10)
Clementine<-read.csv('클레멘타인_네이버 리뷰(2).csv')
head(Clementine,10)
clementine %>%
filter(년도>2003) %>%
group_by(년도) %>%
summarise(평점합계=sum(점수,na.rm=T),갯수=n(),평점=평점합계/갯수) %>%
ggplot(aes(x=as.factor(년도), y=평점합계, fill=as.factor(년도)))+
geom_bar(stat="identity",color="black") +
geom_point(aes(y=갯수*8),shape=20,size=8,col='red')+
geom_text(aes(y=평점합계+1000,label=paste0(평점합계,"점")),
color='black',
size=5,
family="baedal") +
geom_text(aes(y=갯수*8-1000,label=paste0(갯수,'개')),
color='white',
size=5,
family="baedal") +
geom_text(aes(y=-1000,label=paste0(round(평점,2),'점')),
color='black',
size=5,
family="baedal") +
geom_hline(yintercept=seq(0,30000,2500),lty='dashed',size=0.5) +
theme_bw(base_family='baedal',
base_size = 20,
base_rect_size = 3,
base_line_size = 1) +
labs(x='년도') +
ggtitle('클레멘타인 년도별 평점(막대:합계, 점:갯수, 밑:평점평균)') +
theme(legend.position = "none",
axis.text.x  = element_text(angle=45, hjust=1),
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 30,
color = "black"))
clementine %>%
group_by(월) %>%
summarise(평점합계=sum(점수,na.rm=T),갯수=n(),평점=평점합계/갯수) %>%
ggplot(aes(x=as.factor(월), y=평점합계, fill=as.factor(월)))+
geom_bar(stat="identity",color="black") +
geom_point(aes(y=갯수*9),col='red',shape=20,size=8)+
geom_text(aes(y=평점합계+1000,label=paste0(평점합계,"점")),
color='black',
size=5,
family="baedal") +
geom_text(aes(y=갯수*9-1000,label=paste0(갯수,'개')),
color='white',
size=5,
family="baedal") +
geom_text(aes(y=-1000,label=paste0(round(평점,2),'점')),
color='black',
size=5,
family="baedal") +
geom_hline(yintercept=seq(0,30000,2500),lty='dashed',size=0.5) +
theme_bw(base_family='baedal',base_size = 20) +
theme(axis.text.x  = element_text(hjust=1)) +
labs(x='월') +
ggtitle('클레멘타인 월별 평점(막대:합계, 점:갯수, 밑:평점평균)') +
theme(legend.position = "none",
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 30,
color = "black"))
clementine %>%
group_by(일) %>%
summarise(평점합계=sum(점수,na.rm=T),갯수=n(),평균=평점합계/갯수) %>%
ggplot(aes(x=as.factor(일), y=평점합계, fill=as.factor(일)))+
geom_bar(stat="identity",color="black") +
geom_point(aes(y=갯수*9),col='red',shape=20,size=8)+
geom_text(aes(y=평점합계+400,label=paste0(평점합계,"점")),
color='black',
size=4,
family="baedal") +
geom_text(aes(y=갯수*9-500,label=paste0(갯수,'개')),
color='white',
size=4,
family="baedal") +
geom_text(aes(y=-500,label=paste0(round(평균,2),'점')),
color='black',
size=4,
family="baedal") +
geom_hline(yintercept=seq(0,15000,2500),lty='dashed',size=0.5) +
theme_bw(base_family='baedal',base_size = 20) +
labs(x='일') +
ggtitle('클레멘타인 일별 평점(막대:합계, 점:갯수, 밑:평점평균)') +
theme(legend.position = "none",
axis.text.x  = element_text(hjust=1),
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 30,
color = "black"))
# 5. 시간별 평점
clementine$시 <- clementine$시간 %>% str_sub(1,2) %>% gsub('00','24',.)
clementine %>%
group_by(시) %>%
summarise(평점합계=sum(점수,na.rm=T),갯수=n(),평균=평점합계/갯수) %>%
ggplot(aes(x=as.factor(시), y=평점합계, fill=시))+
geom_bar(stat="identity",color="black") +
geom_point(aes(y=갯수*9),col='red',shape=20,size=8)+
geom_text(aes(y=평점합계+500,label=paste0(평점합계,"점")),
color='black',
size=4,
family="baedal") +
geom_text(aes(y=갯수*9-500,label=paste0(갯수,'개')),
color='white',
size=4,
family="baedal") +
geom_text(aes(y=-500,label=paste0(round(평균,2),'점')),
color='black',
size=4,
family="baedal") +
geom_hline(yintercept=seq(0,15000,2500),lty='dashed',size=0.5) +
theme_bw(base_family='baedal',base_size = 20) +
labs(x='시간') +
ggtitle('클레멘타인 시간별 평점(막대:합계, 점:갯수, 밑:평점평균)') +
theme(legend.position = "none",
axis.text.x  = element_text(hjust=1),
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 30,
color = "black"))
clementine %>%
group_by(점수) %>%
summarise(갯수=n())
library(dplyr)
library(ggplot2)
library(stringr)
clementine %>%
group_by(점수) %>%
summarise(갯수=n())
clementine
library(dplyr)
library(ggplot2)
library(stringr)
clementine$ %>%
library(dplyr)
library(ggplot2)
library(stringr)
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(년도), y=평점합계, fill=as.factor(년도)))+
geom_bar(stat="identity",color="black")
clementine %>%
group_by(점수)
clementine %>%
group_by(점수) %>%
summarise(갯수=n())
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(년도), y=평점합계, fill=as.factor(년도)))+
geom_bar(stat="identity",color="black")
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black")
library(dplyr)
library(ggplot2)
library(stringr)
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black") +
theme_bw(base_family='baedal',
base_size = 10,
base_rect_size = 4,
base_line_size = 1) +
labs(x='점수') +
ggtitle('클레멘타인 평점별 댓글수') +
theme(legend.position = "none",
axis.text.x  = element_text(angle=45, hjust=1),
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 18,
color = "black"))
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black") +
theme_bw(base_family='baedal',
base_size = 10,
base_rect_size = 4,
base_line_size = 1) +
labs(x='점수') +
ggtitle('클레멘타인 평점별 댓글수') +
theme(legend.position = "none",
axis.text.x  = element_text(angle=45, hjust=1),
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 18,
color = "black"))
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black") +
theme_bw(base_family='baedal',
base_size = 10,
base_rect_size = 4,
base_line_size = 1) +
labs(x='점수') +
ggtitle('클레멘타인 평점별 댓글수') +
theme(legend.position = "none",
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 18,
color = "black"))
windowsFonts(baedal=windowsFont("배달의민족 도현"))
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black") +
theme_bw(base_family='baedal',
base_size = 10,
base_rect_size = 4,
base_line_size = 1) +
labs(x='점수') +
ggtitle('클레멘타인 평점별 댓글수') +
theme(legend.position = "none",
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 18,
color = "black"))
lementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black") +
geom_text(aes(y=갯수+100,label=paste0(갯수,"개")),
color='black',
size=2.5,
family="baedal") +
theme_bw(base_family='baedal',
base_size = 10,
base_rect_size = 4,
base_line_size = 1) +
labs(x='점수') +
ggtitle('클레멘타인 평점별 댓글수') +
theme(legend.position = "none",
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 18,
color = "black"))
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black") +
geom_text(aes(y=갯수+100,label=paste0(갯수,"개")),
color='black',
size=2.5,
family="baedal") +
theme_bw(base_family='baedal',
base_size = 10,
base_rect_size = 4,
base_line_size = 1) +
labs(x='점수') +
ggtitle('클레멘타인 평점별 댓글수') +
theme(legend.position = "none",
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 18,
color = "black"))
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black") +
geom_text(aes(y=갯수+1000,label=paste0(갯수,"개")),
color='black',
size=5,
family="baedal") +
theme_bw(base_family='baedal',
base_size = 10,
base_rect_size = 4,
base_line_size = 1) +
labs(x='점수') +
ggtitle('클레멘타인 평점별 댓글수') +
theme(legend.position = "none",
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 18,
color = "black"))
clementine %>%
group_by(점수) %>%
summarise(갯수=n()) %>%
ggplot(aes(x=as.factor(점수), y=갯수, fill=as.factor(점수)))+
geom_bar(stat="identity",color="black") +
geom_text(aes(y=갯수+1000,label=갯수),
color='black',
size=5,
family="baedal") +
theme_bw(base_family='baedal',
base_size = 10,
base_rect_size = 4,
base_line_size = 1) +
labs(x='점수') +
ggtitle('클레멘타인 평점별 댓글수') +
theme(legend.position = "none",
plot.title = element_text(family="baedal",
face = "bold",
hjust = 0.5,
vjust = 1,
size = 18,
color = "black"))
